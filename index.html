<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Transmission Interceptée</title>

<style>
body {
    margin:0;
    background: radial-gradient(circle at center, #150000 0%, #000 80%);
    color: #f5f5f5;
    font-family: "Consolas", monospace;
    text-align: center;
    overflow:hidden;
}

body.activated {
    background: radial-gradient(circle at center, #400000 0%, #000 70%);
}

.screen {
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    height:100vh;
}

#mainContent {
    display:none;
    padding:40px;
}

h1 { color: gold; letter-spacing:4px; }

.message { margin-top:30px; line-height:1.8; }

.grid {
    display:grid;
    grid-template-columns:repeat(6,80px);
    grid-template-rows:repeat(6,80px);
    gap:8px;
    justify-content:center;
    margin-top:40px;
    opacity:0.4;
    pointer-events:none;
}

.grid img {
    width:80px;
    height:80px;
    background:black;
    padding:8px;
    border:1px solid #330000;
    cursor:pointer;
    transition:0.2s;
}

.grid img:hover {
    border:1px solid gold;
    transform:scale(1.05);
}

.slots {
    display:flex;
    justify-content:center;
    gap:10px;
    margin-top:30px;
}

.slot {
    width:60px;
    height:60px;
    border:1px solid darkred;
    background:black;
    display:flex;
    align-items:center;
    justify-content:center;
}

button {
    margin-top:20px;
    padding:10px 30px;
    background:black;
    border:1px solid darkred;
    color:gold;
    cursor:pointer;
}
</style>
</head>

<body>

<div class="screen" id="startScreen">
    <button onclick="start()">DÉMARRER TRANSMISSION</button>
</div>

<div id="mainContent">
    <h1>TRANSMISSION INTERCEPTÉE</h1>
    <div class="message">
        Cherchez ce qui demeure lorsque tout le reste se répète.<br>
        Le centre précède la périphérie.
    </div>

    <div class="grid" id="grid"></div>

    <div class="slots">
        <div class="slot"></div>
        <div class="slot"></div>
        <div class="slot"></div>
        <div class="slot"></div>
        <div class="slot"></div>
    </div>

    <button onclick="reset()">RÉINITIALISER</button>

    <div id="result" style="margin-top:20px;color:gold;"></div>
</div>

<script>

const centreX = 2.5;
const centreY = 2.5;

let selection = [];
let locked = false;

// ===== SYMBOLS =====

// 5 uniques positionnés exactement
const uniques = {
    "2-3": {letter:"A", img:"Image1.png"},
    "1-2": {letter:"R", img:"Image2.png"},
    "0-1": {letter:"K", img:"Image3.png"},
    "4-5": {letter:"U", img:"Image4.png"},
    "5-5": {letter:"S", img:"Image5.png"}
};

// 15 paires + 1 paire bonus
const duplicates = [
    "D1.png","D1.png",
    "D2.png","D2.png",
    "D3.png","D3.png",
    "D4.png","D4.png",
    "D5.png","D5.png",
    "D6.png","D6.png",
    "D7.png","D7.png",
    "D8.png","D8.png",
    "D9.png","D9.png",
    "D10.png","D10.png",
    "D11.png","D11.png",
    "D12.png","D12.png",
    "D13.png","D13.png",
    "D14.png","D14.png",
    "D15.png","D15.png",
    "D16.png","D16.png"
];

let dupIndex = 0;

function start(){
    document.getElementById("startScreen").style.display="none";
    document.getElementById("mainContent").style.display="block";
    generateGrid();
}

function generateGrid(){
    const grid = document.getElementById("grid");

    for(let row=0; row<6; row++){
        for(let col=0; col<6; col++){

            const key = row+"-"+col;
            const img = document.createElement("img");

            if(uniques[key]){
                img.src = uniques[key].img;
                img.dataset.letter = uniques[key].letter;
                img.dataset.row = row;
                img.dataset.col = col;
                img.onclick = selectUnique;
            } else {
                img.src = duplicates[dupIndex];
                dupIndex++;
            }

            grid.appendChild(img);
        }
    }

    grid.style.opacity="1";
    grid.style.pointerEvents="auto";
}

function selectUnique(){
    if(locked || selection.length>=5) return;

    const letter = this.dataset.letter;
    const row = parseInt(this.dataset.row);
    const col = parseInt(this.dataset.col);

    selection.push({
        letter:letter,
        distance: Math.sqrt(
            Math.pow(row-centreX,2)+
            Math.pow(col-centreY,2)
        )
    });

    const slot = document.getElementsByClassName("slot")[selection.length-1];
    const clone = this.cloneNode(true);
    slot.appendChild(clone);

    if(selection.length===5) verify();
}

function verify(){

    // tri par distance croissante
    selection.sort((a,b)=>a.distance-b.distance);

    const result = selection.map(s=>s.letter).join("");

    if(result==="ARKUS"){
        locked=true;
        document.body.classList.add("activated");
        document.getElementById("result").innerText="CANAL VALIDÉ";

        setTimeout(()=>{
            window.location.href="countdown.html";
        },2000);

    } else {
        document.getElementById("result").innerText="Correspondance invalide.";
        setTimeout(reset,1500);
    }
}

function reset(){
    if(locked) return;

    selection=[];
    document.getElementById("result").innerText="";

    const slots=document.getElementsByClassName("slot");
    for(let s of slots) s.innerHTML="";
}

</script>

</body>
</html>
